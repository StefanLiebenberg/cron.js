var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;b=b.substring(0,b.lastIndexOf("."));){if(goog.getObjectByName(b))break;goog.implicitNamespaces_[b]=!0}}goog.exportPath_(a)};
goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};if(!COMPILED)goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={};goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};
goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(!COMPILED){for(var d,a=a.replace(/\\/g,"/"),e=goog.dependencies_,i=0;d=b[i];i++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){return a.instance_||(a.instance_=new a)}};
if(!COMPILED&&goog.ENABLE_DEBUG_LOADER)goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return typeof a!="undefined"&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;b>=0;--b){var c=a[b].src,d=c.lastIndexOf("?"),
d=d==-1?c.length:d;if(c.substr(d-7,7)=="base.js"){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){return goog.inHtmlDocument_()?(goog.global.document.write('<script type="text/javascript" src="'+a+'"><\/script>'),!0):!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=
!0,e in d.requires))for(var j in d.requires[e])if(!goog.isProvided_(j))if(j in d.nameToPath)a(d.nameToPath[j]);else throw Error("Undefined nameToPath for "+j);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),
goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js");
goog.typeOf=function(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b};goog.propertyIsEnumerableCustom_=function(a,b){if(b in a)for(var c in a)if(c==b&&Object.prototype.hasOwnProperty.call(a,b))return!0;return!1};goog.propertyIsEnumerable_=function(a,b){return a instanceof Object?Object.prototype.propertyIsEnumerable.call(a,b):goog.propertyIsEnumerableCustom_(a,b)};goog.isDef=function(a){return a!==void 0};goog.isNull=function(a){return a===null};goog.isDefAndNotNull=function(a){return a!=null};
goog.isArray=function(a){return goog.typeOf(a)=="array"};goog.isArrayLike=function(a){var b=goog.typeOf(a);return b=="array"||b=="object"&&typeof a.length=="number"};goog.isDateLike=function(a){return goog.isObject(a)&&typeof a.getFullYear=="function"};goog.isString=function(a){return typeof a=="string"};goog.isBoolean=function(a){return typeof a=="boolean"};goog.isNumber=function(a){return typeof a=="number"};goog.isFunction=function(a){return goog.typeOf(a)=="function"};
goog.isObject=function(a){a=goog.typeOf(a);return a=="object"||a=="array"||a=="function"};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};goog.UID_PROPERTY_="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;
goog.cloneObject=function(a){var b=goog.typeOf(a);if(b=="object"||b=="array"){if(a.clone)return a.clone();var b=b=="array"?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}else return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){goog.bind=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval){if(goog.evalWorksForGlobals_==null)goog.global.eval("var _et_ = 1;"),typeof goog.global._et_!="undefined"?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d;d=goog.cssNameMapping_?goog.cssNameMappingStyle_=="BY_WHOLE"?c:function(a){for(var a=a.split("-"),b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")}:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
goog.getMsg=function(a,b){var c=b||{},d;for(d in c)var e=(""+c[d]).replace(/\$/g,"$$$$"),a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e);return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),i=!1,j=a.constructor;j;j=j.superClass_&&j.superClass_.constructor)if(j.prototype[b]===d)i=!0;else if(i)return j.prototype[b].apply(a,e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);else throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};var sage={cron:{}};sage.cron.Job=function(a,b){typeof a==="string"&&(a=new sage.cron.Spec(a));this.cronspec_=a;this.block_=b;this.last_at=null;this.calcNextAt_()};sage.cron.Job.prototype.calcNextAt_=function(){var a=new Date,b;if(this.last_at)for(b=this.cronspec_.next(this.last_at);b<a;)b=this.cronspec_.next(b);else b=this.cronspec_.next(a);this.next_at=b};sage.cron.Job.prototype.getNextTimeout=function(a){a||(a=new Date);this.next_at||this.calcNextAt_();return Math.max(10,this.next_at-a)};
sage.cron.Job.prototype.run=function(){this.last_at=new Date;setTimeout(this.block_,10);this.calcNextAt_()};sage.cron.Scheduler=function(){this.jobs_=[];this.running_=!1};sage.cron.Scheduler.prototype.add=function(a){this.jobs_.push(a);this.running_&&this.next()};sage.cron.Scheduler.prototype.remove=function(a){for(var b;(b=this.jobs.indexOf(a))!==-1;)this.jobs_.splice(b)};sage.cron.Scheduler.prototype.start=function(){if(!this.running_)this.running_=!0,this.next()};sage.cron.Scheduler.prototype.stop=function(){if(this.running_)this.running_=!1,clearTimeout(this.stored_timeout_),delete this.stored_timeout_};
sage.cron.Scheduler.prototype.next=function(){if(this.running_&&!(this.stored_timeout_||this.jobs_.length===0)){for(var a=this.jobs_[0],b=1,c=this.jobs_.length;b<c;b++)this.jobs_[b].next_at_<a.next_at_&&(a=this.jobs_[b]);var d=this;this.storedTimeout=setTimeout(function(){a.run();delete d.storedTimeout;d.next()},a.getNextTimeout())}};sage.util={};sage.util.Parser=function(){};sage.util.Parser.prototype.parse=function(a){return this.parseInternal.apply(this,arguments)};sage.util.Parser.prototype.parseInternal=function(a){return a};sage.util.StringParser=function(a){sage.util.Parser.call(this);this.regex=a};goog.inherits(sage.util.StringParser,sage.util.Parser);sage.util.StringParser.prototype.test=function(a){this.regex.lastIndex=0;return this.regex.test(a)};
sage.util.StringParser.prototype.parseInternal=function(a){if(this.test(a))return this.regex.lastIndex=0,a.match(this.regex)};sage.cron.syntax={};sage.cron.syntax.AllParser=function(){sage.util.StringParser.call(this,/^\*$/)};goog.inherits(sage.cron.syntax.AllParser,sage.util.StringParser);sage.cron.syntax.AllParser.prototype.parseInternal=function(a,b){return b.range.getValues()};sage.cron.syntax.RangeParser=function(a){sage.util.StringParser.call(this,RegExp("^"+a+"-"+a+"$"),this.parseInternal)};goog.inherits(sage.cron.syntax.RangeParser,sage.util.StringParser);sage.cron.syntax.RangeParser.prototype.parseInternal=function(a,b){var c=a.split("-"),d=parseInt(c[0])-b.range.from,c=parseInt(c[1])-b.range.from;return b.range.getValues().slice(d,c+1)};sage.cron.syntax.IncrementParser=function(a){sage.util.StringParser.call(this,RegExp("^[^/]+/"+a+"$"))};goog.inherits(sage.cron.syntax.IncrementParser,sage.util.StringParser);sage.cron.syntax.IncrementParser.prototype.parseInternal=function(a,b){for(var c=a.split("/"),d=b.parse(c[0]),c=parseInt(c[1]),e=[],i=0,j=d.length;i<j;i+=c)e.push(d[i]);return e};sage.util.Range=function(a,b){if(a>b)throw Error("sage.util.Range: from is larger than to");this.from=a;this.to=b;this.length=1+b-a};sage.util.Range.prototype.valueAt=function(a){return a<0||a>=this.length?void 0:this.from+a};sage.util.Range.prototype.indexOf=function(a){var b=-1;a>=this.from&&a<=this.to&&(b=a-this.from);return b};sage.util.Range.prototype.getValues=function(a,b){if(arguments.length!==2&&(b=this.to,arguments.length===0))a=this.from;return this.getValuesInternal(a,b)};
sage.util.Range.prototype.getValuesInternal=function(a,b){var c,d;if(a>b||a<this.from||b>this.to)throw c="sage.util.Range: ",c+="values are out of range",Error(c);c=1+b-a;d=Array(c);if(c>0)for(;c--;)d[c]=a+c;return d};sage.util.Range.prototype.toString=function(){return"Range["+this.from+".."+this.to+"]"};sage.util.array={};sage.util.array.uniq=function(a){for(var b=a.length,c,d,e=0;e<b;e+=1){c=a[e];for(d=e+1;(d=a.indexOf(c,d))!==-1;)a.splice(d,1),b--}return a};sage.util.RangeParser=function(a,b){this.range=new sage.util.Range(a,b);this.parsers=[]};goog.inherits(sage.util.RangeParser,sage.util.Parser);sage.util.RangeParser.prototype.parseInternal=function(a){for(var b=[],c=this.parsers.length,d,e=0;e<c;e++)if(d=this.parsers[e],d.test(a)){b=d.parse(a,this);sage.util.array.uniq(b);b.sort(function(a,b){return a-b});break}return b};sage.cron.syntax.SingleParser=function(a){sage.util.StringParser.call(this,RegExp("^"+a+"$"))};goog.inherits(sage.cron.syntax.SingleParser,sage.util.StringParser);sage.cron.syntax.SingleParser.prototype.parseInternal=function(a,b){var c=parseInt(a)-b.range.from;return[b.range.valueAt(c)]};sage.cron.syntax.AliasParser=function(){sage.util.StringParser.call(this,/([a-z][a-z][a-z])|([A-Z][A-Z][A-Z])/g);this.aliases={}};goog.inherits(sage.cron.syntax.AliasParser,sage.util.StringParser);sage.cron.syntax.AliasParser.prototype.parseInternal=function(a,b){a=a.replace(this.regex,function(a){a=a.toLowerCase();a in b.aliases&&(a=b.aliases[a]);return a});return b.parse(a)};sage.cron.syntax.CommaParser=function(){sage.util.StringParser.call(this,/\,/,this.parseInternal)};goog.inherits(sage.cron.syntax.CommaParser,sage.util.StringParser);sage.cron.syntax.CommaParser.prototype.parseInternal=function(a,b){var c,d,e;c=a.split(",");e=c.length;d=[];for(var i=0;i<e;i++)d.push.apply(d,b.parse(c[i]));return d};sage.cron.SpecParser=function(a,b,c){sage.util.RangeParser.call(this,a,b);this.allow=c;this.parsers[0]=new sage.cron.syntax.CommaParser;this.parsers[1]=new sage.cron.syntax.AllParser;this.parsers[2]=new sage.cron.syntax.SingleParser(this.allow);this.parsers[3]=new sage.cron.syntax.RangeParser(this.allow);this.parsers[4]=new sage.cron.syntax.IncrementParser(this.allow)};goog.inherits(sage.cron.SpecParser,sage.util.RangeParser);
sage.cron.AliasSpecParser=function(a,b,c){sage.cron.SpecParser.call(this,a,b,c);this.parsers[5]=new sage.cron.syntax.AliasParser(this.allow)};goog.inherits(sage.cron.AliasSpecParser,sage.cron.SpecParser);sage.cron.SpecSecondParser=new sage.cron.SpecParser(0,59,"[1-5]?[0-9]");sage.cron.SpecMinuteParser=new sage.cron.SpecParser(0,59,"[1-5]?[0-9]");sage.cron.SpecHourParser=new sage.cron.SpecParser(0,23,"(([0-1]?[0-9])|([2][0-3]))");sage.cron.SpecDayParser=new sage.cron.SpecParser(1,31,"(([0]?[1-9])|([1-2][0-9])|([3][0-1]))");sage.cron.SpecMonthParser=new sage.cron.AliasSpecParser(1,12,"(([0]?[1-9])|([1][0-2]))");
sage.cron.SpecMonthParser.aliases={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12};sage.cron.SpecWeekdayParser=new sage.cron.AliasSpecParser(1,7,"([0]?[1-7])");sage.cron.SpecWeekdayParser.aliases={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};sage.util.date={};sage.util.date.addTime=function(a,b){var c=a.getTime();a.setTime(c+b);return a};sage.util.date.addSeconds=function(a,b){var c=a.getSeconds();a.setSeconds(c+b);return a};sage.util.date.addMinutes=function(a,b){var c=a.getMinutes();a.setMinutes(c+b);return a};sage.util.date.addHours=function(a,b){var c=a.getHours();a.setHours(c+b);return a};sage.util.date.addDays=function(a,b){var c=a.getDate();a.setDate(c+b);return a};
sage.util.date.addMonths=function(a,b){var c=a.getMonth();a.setMonth(c+b);return a};sage.util.date.addYears=function(a,b){var c=a.getFullYear();a.setFullYear(c+b);return a};sage.cron.Spec=function(a){a=a.trim();a in sage.cron.Spec.aliases_&&(a=sage.cron.Spec.aliases_[a]);this.spec=a;var b=a.split(" ");if(b.length!==6)throw b="CronSpec only accepts specifications with 6 parts:",b+=a,b+=" is invalid",Error(b);this.seconds=sage.cron.SpecSecondParser.parse(b[0]);this.minutes=sage.cron.SpecMinuteParser.parse(b[1]);this.hours=sage.cron.SpecHourParser.parse(b[2]);this.days=sage.cron.SpecDayParser.parse(b[3]);this.months=sage.cron.SpecMonthParser.parse(b[4]);this.weekdays=sage.cron.SpecWeekdayParser.parse(b[5])};
sage.cron.Spec.prototype.next=function(a){var b=new Date;b.setTime(a.getTime());sage.util.date.addSeconds(b,1);b.setMilliseconds(0);for(var c=(a=this.seconds.length)&&a!==60,d=this.minutes.length,e=d&&d!==60,i=this.hours.length,j=i&&i!==24,k=this.weekdays.length,o=k&&k!==7,l=this.days.length,p=l&&l.length!==31,m=this.months.length,q=m&&m!==12,n=!1,g,h;!n;)if(g=b.getSeconds(),c&&this.seconds.indexOf(g)===-1){h=!0;for(var f=0;f<a;f++)if(this.seconds[f]>=g){b.setSeconds(this.seconds[f]);h=!1;break}h&&
(b.setSeconds(0),sage.util.date.addMinutes(b,1))}else if(g=b.getMinutes(),e&&this.minutes.indexOf(g)==-1){h=!0;for(f=0;f<d;f++)if(this.minutes[f]>=g){b.setMinutes(this.minutes[f]);h=!1;break}h&&(b.setMinutes(0),sage.util.date.addHours(b,1))}else{g=b.getHours();if(j&&this.hours.indexOf(g)==-1){h=!0;for(f=0;f<i;f++)if(this.hours[f]>=g){b.setHours(this.hours[f]);h=!1;break}if(h){sage.util.date.addDays(b,1);b.setSeconds(0);b.setMinutes(0);b.setHours(0);continue}}g=b.getDay()+1;if(o&&this.weekdays.indexOf(g)==
-1){h=!0;for(f=0;f<k;f++)if(this.weekdays[f]>=g){sage.util.date.addDays(b,this.weekdays[f]-g-1);h=!1;break}if(h){sage.util.date.addDays(b,8-g);b.setSeconds(0);b.setMinutes(0);b.setHours(0);continue}}g=b.getDate();if(p&&this.days.indexOf(g)==-1){h=!0;for(f=0;f<l;f++)if(this.days[f]>=g){for(;b.getDate()!=this.days[f];)b.setDate(this.days[f]);h=!1;break}b.setSeconds(0);b.setHours(0);b.setMinutes(0);h&&(b.setDate(1),sage.util.date.addMonths(b,1))}else if(g=b.getMonth()+1,q&&this.months.indexOf(g)==-1){h=
!0;for(f=0;f<m;f++)if(this.months[f]>=g){b.setMonth(this.months[f]-1);h=!1;break}b.setSeconds(0);b.setMinutes(0);b.setHours(0);b.setDate(1);h&&(b.setMonth(0),sage.util.date.addYears(b,1))}else n=!0}return b};sage.cron.Spec.aliases_={"@second":"* * * * * *","@minute":"0 * * * * *","@halfminute":"0,30 * * * * *","@hour":"0 0 * * * *","@halfhour":"0 0,30 * * *","@daily":"0 0 0 * * *","@monthly":"0 0 0 1 * *","@yearly":"0 0 0 1 1 *","@weekly":"0 0 0 * * 1","@weekday":"0 0 0 * * 2-6"};
sage.cron.Spec.next=function(a,b){return b.next(a)};sage.cron.Spec.parse=function(a){return new sage.cron.Spec(a)};var cron={js:{}};goog.exportSymbol("Cron",sage.cron.Scheduler);goog.exportSymbol("Cron.prototype.start",sage.cron.Scheduler.prototype.start);goog.exportSymbol("Cron.prototype.add",sage.cron.Scheduler.prototype.add);goog.exportSymbol("Cron.Spec",sage.cron.Spec);goog.exportSymbol("Cron.Spec.prototype.next",sage.cron.Spec.prototype.next);goog.exportSymbol("Cron.Spec.next",sage.cron.Spec.next);goog.exportSymbol("Cron.Spec.parse",sage.cron.Spec.parse);goog.exportSymbol("Cron.Job",sage.cron.Job);
